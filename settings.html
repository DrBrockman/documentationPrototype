<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
       .btn-activeF {
    background-color: #007bff;
    color: white;
}
      </style>
</head>
<body>

  <div class="container mt-5">
    <h1>Person List</h1>
    <table class="table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Date</th>
          <th>Start</th>
          <th>End</th>
        </tr>
      </thead>
      <tbody id="personTableBody">
        <!-- JavaScript will populate rows here -->
      </tbody>
    </table>
  </div>
  
 <!-- Modal for editing person details -->
 <div class="modal fade" id="editModal" tabindex="-1" role="dialog">
  <div class="modal-dialog " role="document">
    <div class="modal-content">
      <div class="modal-header ">
        <h5 class="modal-title">Edit Person Details</h5>
        
        <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true"></span>
        </button>
      </div>
      <div class="modal-body">
        
        <form id="editForm">
          
          
            
              
                <div class="row g-3">
                  <div class="col-6">
                    <div class="form-group">
                      <label for="name">Name</label>
                      <input type="text" class="form-control" id="name" name="name">
                    </div>
                  </div>
                  <div class="col">
                    <label for="start">Start</label>
                    <input type="text" class="form-control" id="start" aria-label="First name">
                  </div>
                  <div class="col">
                    <label for="end">End</label>
                    <input type="text" class="form-control" id="end" aria-label="Last name">
                  </div>
                </div>
                
                <div class="form-floating pb-3 pt-3" >
                  <textarea class="form-control" id="subjective" name="subjective" placeholder="Subjective"></textarea>
                  <label for="subjective">Subjective</label>
                </div>
                
                <div class="btn-group w-100 pb-1" role="group" aria-label="Basic radio toggle button group">
                  <button class="btn btn-outline-primary collapse-button" type="button" data-toggle="collapse" data-target="#collapseContent1" aria-expanded="false" aria-controls="collapseContent1">Functional</button>
                  <button class="btn btn-outline-primary collapse-button" type="button" data-toggle="collapse" data-target="#collapseContent2" aria-expanded="false" aria-controls="collapseContent2">Soft Tissue</button>
                  <button class="btn btn-outline-primary collapse-button" type="button" data-toggle="collapse" data-target="#collapseContent3" aria-expanded="false" aria-controls="collapseContent3">Joint</button>
                  <button class="btn btn-outline-primary collapse-button" type="button" data-toggle="collapse" data-target="#collapseContent4" aria-expanded="false" aria-controls="collapseContent4">Dry Needle</button>
                </div>
              
                <div class="collapse collapse-content" id="collapseContent1">
                  <div class="d-flex flex-wrap gap-1" >
                    <input type="checkbox" class=" btn-check " id="btnCheck1" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck1">ADL</label>
                  
                    <input type="checkbox" class=" btn-check" id="btnCheck2" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck2">Balance</label>
                  
                    <input type="checkbox" class="btn-check" id="btnCheck3" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck3">Endurance</label>
                    <input type="checkbox" class=" btn-check" id="btnCheck4" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck4">Ergonomics</label>
                    <input type="checkbox" class="btn-check" id="btnCheck5" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck5">Gait</label>
                    <input type="checkbox" class="btn-check" id="btnCheck6" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck6">Posture</label> 
                    <input type="checkbox" class="btn-check" id="btnCheck7" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck7">Athletics</label>
                    <input type="checkbox" class="btn-check" id="btnCheck8" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck8">Transfers</label>
                    <input type="checkbox" class="btn-check" id="btnCheck9" autocomplete="off">
                    <label class="btn btn-outline-primary" for="btnCheck9">Work Task</label>
                  </div>
                </div>

                <div class="collapse collapse-content" id="collapseContent2">
                  <div class="form-floating pb-3" >
                    <textarea class="form-control" id="softy" name="softy" placeholder="Soft Tissue"></textarea>
                    <label for="softy">Soft Tissue</label>
                  </div>
                </div>


                <div class="collapse collapse-content" id="collapseContent3">
                  <div class="form-floating pb-3" >
                    <textarea class="form-control" id="mob" name="mob" placeholder="Joint Mobilization"></textarea>
                    <label for="mob">Joint Mobilization</label>
                  </div>
                </div>
                
                <div class="collapse collapse-content" id="collapseContent4">
                  <div class="form-floating pb-3" >
                    <textarea class="form-control" id="dn" name="dn" placeholder="Dry Needling"></textarea>
                    <label for="dn">Dry Needling</label>
                  </div>
                </div>

          
                <div class="form-floating pt-3 pb-3" >
                  <textarea class="form-control" id="assessment" name="assessment" placeholder="Assessment"></textarea>
                  <label for="assessment">Assessment</label>
                </div>

                <div class="form-floating pb-3" >
                  <textarea class="form-control" id="plan" name="plan" placeholder="Plan"></textarea>
                  <label for="plan">Plan</label>
                </div>

                <div class="input-group mb-3">
                  <span class="input-group-text" id="basic-addon2">TE</span>
                  <input type="text" class="form-control"  >
                  <span class="input-group-text" id="basic-addon">TA</span>
                  <input type="text" class="form-control"   >
                  <span class="input-group-text" id="basic-addon2">Manual</span>
                  <input type="text" class="form-control"  >
                  <span class="input-group-text" id="basic-addon">NMRE</span>
                  <input type="text" class="form-control"   >
                </div>

  
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary" id="saveChanges">Save Changes</button>
      </div>
    </div>
  </div>
</div>
    
   
    <script>
      var newArray = []; // Create an empty array to store the data

async function getit() {
  var url = `https://script.google.com/macros/s/AKfycbyPBAWJ0hmofn1usjBHbiH5mlak0cIS1--m49g6Zn00z8h62neQsCbQMzOYCBvkU5Xe5g/exec?action=fetchSpreadsheetData`;

  try {
    const response = await fetch(url);

    if (response.ok) {
      const data = await response.json();
      // Assuming the data from the server is an array of objects with 'name', 'date', 'start', and 'end' properties
      newArray.push(...data); // Push the data into personsArray
      console.log(newArray); // Log the data received from the server

      // Loop through personsArray and create table rows
      newArray.forEach((person, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${person.name}</td>
          <td>${person.date}</td>
          <td>${person.start}</td>
          <td>${person.end}</td>
        `;

        // Attach a click event listener to each row
        row.addEventListener('click', () => openEditModal(index));

        personTableBody.appendChild(row);
      });
    } else {
      throw new Error('Request failed with status: ' + response.status);
    }
  } catch (error) {
    console.error(error); // Handle any errors
  }
}
   // Function to get people array from local storage
   if (!localStorage.getItem('personsArray')) {
  localStorage.setItem('personsArray', JSON.stringify([
  {
    name: "John Doe",
    date: "2023-08-23",
    start: "09:00 AM",
    end: "11:00 AM",
    softy: "Soft example data 1",
    dn: "Dryn example data 1",
    mob: "Mobbin example data 1",
    assessment: "Assessment example data 1",
    plan: "Plan example data 1"
  },
  {
    name: "Jane Smith",
    date: "2023-08-24",
    start: "02:00 PM",
    end: "04:00 PM",
    softy: "Soft example data 2",
    dn: "Dryn example data 2",
    mob: "Mobbin example data 2",
    assessment: "Assessment example data 2",
    plan: "Plan example data 2"
  },
  {
    name: "Michael Johnson",
    date: "2023-08-25",
    start: "10:30 AM",
    end: "12:30 PM",
    softy: "Soft example data 3",
    dn: "Dryn example data 3",
    mob: "Mobbin example data 3",
    assessment: "Assessment example data 3",
    plan: "Plan example data 3"
  }
]));
}
// Get the table body element
const personTableBody = document.getElementById('personTableBody');
const personsArray = JSON.parse(localStorage.getItem('personsArray'));

// Loop through the array and populate the table rows
personsArray.forEach((person, index) => {
  const row = document.createElement('tr');
  row.innerHTML = `
    <td>${person.name}</td>
    <td>${person.date}</td>
    <td>${person.start}</td>
    <td>${person.end}</td>
  `;

  // Attach a click event listener to each row
  row.addEventListener('click', () => openEditModal(index));

  personTableBody.appendChild(row);
});

function openEditModal(index) {
  const person = personsArray[index];
  const editForm = document.getElementById('editForm');

  // Populate the form fields with person's data
  editForm.name.value = person.name || "";
  editForm.start.value = person.start || "";
  editForm.end.value = person.end || "";
    editForm.subjective.value = person.subjective || "";
    editForm.softy.value = person.softy || "";
    editForm.dn.value = person.dn || "";
    editForm.mob.value = person.mob || "";
    editForm.assessment.value = person.assessment || "";
    editForm.plan.value = person.plan || "";
  // Populate other form fields as needed

  // Show the modal
  $('#editModal').modal('show');

  // Save the index of the person being edited
  editForm.setAttribute('data-person-index', index);
}
const saveChangesButton = document.getElementById('saveChanges');
saveChangesButton.addEventListener('click', () => {
  const editForm = document.getElementById('editForm');
  const index = editForm.getAttribute('data-person-index');

  // Update the person's data in the array
  personsArray[index].name = editForm.name.value;
  personsArray[index].start = editForm.start.value;
  personsArray[index].end = editForm.end.value;
  personsArray[index].subjective = editForm.subjective.value;
  personsArray[index].softy = editForm.softy.value;
  personsArray[index].dn = editForm.dn.value;
  personsArray[index].mob = editForm.mob.value;
  personsArray[index].assessment = editForm.assessment.value;
  personsArray[index].plan = editForm.plan.value;
  
  // Update other fields as needed

  // Save the updated array back to local storage
  localStorage.setItem('personsArray', JSON.stringify(personsArray));

  // Close the modal
  $('#editModal').modal('hide');

  // Update the table to reflect the changes
  updateTable();
});
function updateTable() {
  // Clear the existing table rows
  personTableBody.innerHTML = '';

  // Repopulate the table rows
  personsArray.forEach((person, index) => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${person.name}</td>
      <td>${person.date}</td>
      <td>${person.start}</td>
      <td>${person.end}</td>
    `;

    // Attach a click event listener to each row
    row.addEventListener('click', () => openEditModal(index));

    personTableBody.appendChild(row);
  });
}
$('.collapse-button').on('click', function() {
        // Toggle active class for the clicked button
        $(this).toggleClass('btn-activeF');

        // Remove active class from other buttons
        $('.collapse-button').not(this).removeClass('btn-activeF');

        // Hide other collapse contents
        $('.collapse-content').not($(this).attr('data-target')).collapse('hide');
    });

</script>
    
</html>